<div class="address-map-container">
  <div class="address-input-section">
    <div class="input-group">
      <mat-form-field class="full-width">
        <mat-label>City (France only)</mat-label>
        <input
          matInput
          type="text"
          [(ngModel)]="addressInput"
          (input)="onAddressInput()"
          (keyup.escape)="suggestions.set([])"
          placeholder="Enter city name and press Enter or click on map"
        />
        <button
          mat-icon-button
          matSuffix
          type="button"
          (click)="clearSelection()"
          [disabled]="!addressInput()"
          title="Clear selection"
        >
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>

      <!-- Autocomplete suggestions dropdown -->
      @if (suggestions().length > 0) {
        <ul class="suggestions-dropdown">
          @for (suggestion of suggestions(); track $index) {
            <li>
              <button
                type="button"
                (click)="selectSuggestion(suggestion)"
                class="suggestion-item"
              >
                {{ suggestion }}
              </button>
            </li>
          }
        </ul>
      }

      <!-- Loading indicator -->
      @if (isLoadingSuggestions()) {
        <div class="loading-spinner">Loading...</div>
      }

      <!-- Error message -->
      @if (errorMessage()) {
        <div class="error-message">{{ errorMessage() }}</div>
      }
    </div>

    <div class="instructions">
      <p>
        <strong>Click on the map</strong> to position the marker on a city center, or search for a French city name above.
      </p>
    </div>
  </div>

  <!-- Leaflet map -->
  <div id="address-map" class="address-map"></div>
</div>
