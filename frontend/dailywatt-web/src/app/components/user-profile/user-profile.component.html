<div style="max-width: 100%; margin: 0 auto;">
  @if (loading()) {
    <div class="card" style="padding: 3rem; text-align: center; color: #94a3b8;">
      <div style="display: inline-flex; align-items: center; gap: 0.75rem; flex-direction: column;">
        <div style="width: 40px; height: 40px; border: 4px solid #e2e8f0; border-top-color: #3ad1c5; border-radius: 50%; animation: spin 0.8s linear infinite;"></div>
        <div>Loading profile...</div>
      </div>
    </div>
  } @else {
    <div class="card">
      <h3>Profil utilisateur</h3>
      @if (profileMessage()) {
        <p class="status">{{ profileMessage() }}</p>
      }
      <form [formGroup]="profileForm" (ngSubmit)="saveProfile()" class="form-row">
        <div class="form-group">
          <mat-form-field>
            <mat-label>Email</mat-label>
            <input matInput type="text" [value]="profile()?.email" disabled>
          </mat-form-field>
        </div>
        <div class="form-group">
          <mat-form-field>
            <mat-label>Username</mat-label>
            <input matInput type="text" formControlName="username" placeholder="Your username">
          </mat-form-field>
        </div>
        <button mat-raised-button color="primary" type="submit" [disabled]="profileSaving()">Update Profile</button>
      </form>

      <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="form-row" style="margin-top: 24px;">
        <div class="form-group">
          <mat-form-field>
            <mat-label>Current Password</mat-label>
            <input matInput type="password" formControlName="currentPassword" placeholder="••••••">
          </mat-form-field>
        </div>
        <div class="form-group">
          <mat-form-field>
            <mat-label>New Password</mat-label>
            <input matInput type="password" formControlName="newPassword" placeholder="At least 6 characters">
          </mat-form-field>
        </div>
        <button mat-raised-button color="primary" type="submit" [disabled]="passwordSaving()">Change Password</button>
      </form>
    </div>
  }
</div>

<style>
  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
</style>
