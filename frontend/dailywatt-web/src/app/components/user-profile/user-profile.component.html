<div style="max-width: 100%; margin: 0 auto;">
  @if (loading()) {
    <div class="card" style="padding: 3rem; text-align: center; color: #94a3b8;">
      <div style="display: inline-flex; align-items: center; gap: 0.75rem; flex-direction: column;">
        <div style="width: 40px; height: 40px; border: 4px solid #e2e8f0; border-top-color: #3ad1c5; border-radius: 50%; animation: spin 0.8s linear infinite;"></div>
        <div>Loading profile...</div>
      </div>
    </div>
  } @else {
    <div class="card">
      <h3>Profil utilisateur</h3>
      @if (profileMessage()) {
        <p class="status">{{ profileMessage() }}</p>
      }
      <form [formGroup]="profileForm" (ngSubmit)="saveProfile()" class="grid two">
        <div>
          <label for="profileEmail">Email</label>
          <input id="profileEmail" type="text" [value]="profile()?.email" disabled>
        </div>
        <div>
          <label for="profileUsername">Username</label>
          <input id="profileUsername" type="text" formControlName="username" placeholder="Votre pseudo">
        </div>
        <button class="btn" type="submit" [disabled]="profileSaving()">Mettre à jour</button>
      </form>

      <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="grid two" style="margin-top:12px;">
        <div>
          <label for="currentPassword">Mot de passe actuel</label>
          <input id="currentPassword" type="password" formControlName="currentPassword" placeholder="••••••">
        </div>
        <div>
          <label for="newPassword">Nouveau mot de passe</label>
          <input id="newPassword" type="password" formControlName="newPassword" placeholder="Au moins 6 caractères">
        </div>
        <button class="btn" type="submit" [disabled]="passwordSaving()">Changer le mot de passe</button>
      </form>
    </div>
  }
</div>

<style>
  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
</style>
